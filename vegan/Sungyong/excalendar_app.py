import streamlit as st
from streamlit_calendar import calendar

class CalendarApp:
    def __init__(self):
        self.calendar_options = {
            "editable": True,
            "selectable": True,
            "headerToolbar": {
                "left": "prev,next today",
                "center": "title",
                "right": "dayGridMonth,listMonth",
            },
            "initialView": "dayGridMonth",
        }

        self.calendar_events = []

        # ìƒ‰ìƒ ì„¤ì •
        self.color_map = {
            "ë°œí‘œ": "#FF6F61",         # ë¶€ë“œëŸ¬ìš´ ì£¼í™©ìƒ‰
            "ì„œë¥˜ ì‹œì‘": "#4FC3F7",    # ë°ì€ í•˜ëŠ˜ìƒ‰
            "ì„œë¥˜ ë§ˆê°": "#81C784",    # ì—°í•œ ì´ˆë¡ìƒ‰
            "ì‹œí—˜ì¼": "#BA68C8",        # ì—°í•œ ë³´ë¼ìƒ‰
            "ë°œí‘œì¼": "#9575CD",       # ì€ì€í•œ ë³´ë¼ìƒ‰
            "ë©´ì ‘": "#FFA726",         # ì˜¤ë Œì§€ìƒ‰
            "ì‹œí—˜ ì ‘ìˆ˜": "#B0BEC5"     # ì°¨ë¶„í•œ íšŒìƒ‰
        }

        # ìº˜ë¦°ë” ë°ì´í„°
        calendar_data = {
            "12ì›”": {
               "1ì¼": ["í•˜ë‚˜ì†í•´ë³´í—˜ ì„œë¥˜ ë§ˆê°"],
                "2ì¼": ["ê¸°ì—…ì€í–‰ ë©´ì ‘"],
                "3ì¼": ["êµ­ë¯¼ì€í–‰ ìµœì¢… ë°œí‘œ", "ì‹ í•œì€í–‰ 2ì°¨ ë©´ì ‘ ë°œí‘œ", "êµ­ë¯¼ì€í–‰ ë™ê³„ ì¸í„´ì‹­ ì„œë¥˜ ë§ˆê°"],
                "4ì¼": ["ì˜ˆê¸ˆë³´í—˜ê³µì‚¬ ì¸í„´ ì„œë¥˜ ë°œí‘œ", "ìš°ë¦¬ìì‚°ìš´ìš© ì„œë¥˜ ë°œí‘œ", "ì‹ í˜‘ì¤‘ì•™íšŒ ì„œë¥˜ ë§ˆê°", "ë¯¸ë˜ì—ì…‹ì¦ê¶Œ ì„œë¥˜ ë§ˆê°"],
                "5ì¼": ["ìš°ì²´êµ­ê¸ˆìœµê°œë°œì› ì„œë¥˜ ë§ˆê°", "ìš°ë¦¬ìì‚°ìš´ìš© 1ì°¨ ë©´ì ‘", "ì¬ê²½ê´€ë¦¬ì‚¬ ì‹œì‘", "íšŒê³„ê´€ë¦¬ ì‹œì‘", "ATìê²©ì‹œí—˜ ì‹œì‘"],
                "6ì¼": ["ë†í˜‘ì€í–‰ 5ê¸‰ ìµœì¢… ë°œí‘œ", "ë†í˜‘ì¤‘ì•™íšŒ 5ê¸‰ ìµœì¢… ë°œí‘œ", "ë†í˜‘ì†í•´ë³´í—˜ ìµœì¢… ë°œí‘œ", "ì‹ ìš©ë³´ì¦ì¬ë‹¨ì¤‘ì•™íšŒ 1ì°¨ ë©´ì ‘ ë°œí‘œ", "ì‹ ìš©ë³´ì¦ì¬ë‹¨ì¤‘ì•™íšŒ 1ì°¨ë©´ì ‘ ë°œí‘œ", "ë§¤ê²½í…ŒìŠ¤íŠ¸ ë°œí‘œ", "íŒŒìƒìƒí’ˆíˆ¬ìê¶Œ ë°œí‘œ", "ìœ ìë¬¸ì¸ë ¥ ë°œí‘œ", "ì™¸í™˜ì „ë¬¸ì—­ ë°œí‘œ"],
                "7ì¼": ["ìš°ë¦¬ê¸ˆìœµìºí”¼íƒˆ í•„ê¸° ì‹œí—˜", "ì „ì‚°ì„¸ë¬´íšŒê³„ ì‹œí—˜"],
                "8ì¼": [],
                "9ì¼": ["ë†í˜‘ì€í–‰ 6ê¸‰ ìµœì¢… ë°œí‘œ", "êµë³´ì¦ê¶Œ ì¸í„´ í•„ê¸° ì‹œí—˜", "ìš°ì²´êµ­ê¸ˆìœµê°œë°œì› ë©´ì ‘", "ê²½ê¸°ì‹ ìš©ë³´ì¦ì¬ë‹¨ ì„œë¥˜ ë§ˆê°"],
                "10ì¼": ["í•œêµ­ì¬ì •ì •ë³´ì› ì¸í„´ ìµœì¢… ë°œí‘œ", "ì‹ ìš©ë³´ì¦ì¬ë‹¨ì¤‘ì•™íšŒ ì¸í„´ ë©´ì ‘ ë°œí‘œ", "ìˆ˜í˜‘ì¤‘ì•™íšŒ 2ì°¨ ë©´ì ‘", "ì¬ê²½ê´€ë¦¬ì‚¬ ë§ˆê°", "íšŒê³„ê´€ë¦¬ ë§ˆê°"],
                "11ì¼": ["êµ­ë¯¼ì€í–‰ ë™ê³„ì¸í„´ì‹­ ì„œë¥˜ ë°œí‘œ", "ì˜ˆê¸ˆë³´í—˜ê³µì‚¬ ì¸í„´ ë©´ì ‘", "ì‹ ìš©ë³´ì¦ì¬ë‹¨ì¤‘ì•™íšŒ 2ì°¨ ë©´ì ‘", "ATìê²©ì‹œí—˜"],
                "12ì¼": ["êµ­ë¯¼ì—°ê¸ˆê³µë‹¨ ìµœì¢… ë°œí‘œ", "ê¸°ì—…ì€í–‰ ë™ê³„ì¸í„´ ì„œë¥˜ ë°œí‘œ"],
                "13ì¼": ["AFPK ë°œí‘œ", "êµ­ë¯¼ì€í–‰ ë™ê³„ì¸í„´ì‹­ ë©´ì ‘"],
                "14ì¼": ["ê²½ê¸°ì‹ ìš©ë³´ì¦ì¬ë‹¨ í•„ê¸° ì‹œí—˜"],
                "15ì¼": ["êµë³´ì¦ê¶Œ ì¸í„´ ì„œë¥˜ ë§ˆê°"],
                "16ì¼": ["ì˜ˆê¸ˆë³´í—˜ê³µì‚¬ ì¸í„´ ë©´ì ‘ ë°œí‘œ", "ì‹ ìš©ë³´ì¦ì¬ë‹¨ì¤‘ì•™íšŒ ìµœì¢… ë°œí‘œ", "ìš°ì²´êµ­ê¸ˆìœµê°œë°œì› ìµœì¢… ë°œí‘œ", "í…Œì…‹ ë§ˆê°"],
                "17ì¼": ["ìœ í†µê´€ë¦¬ì‚¬ 2ê¸‰ ë°œí‘œ"],
                "18ì¼": ["ìš°ë¦¬ì€í–‰ ì²´í—˜í˜• ì¸í„´ ì„œë¥˜ ë°œí‘œ", "êµë³´ì¦ê¶Œ ì¸í„´ ì‹¤ë¬´ ë©´ì ‘"],
                "19ì¼": ["ì§€ì—­ë†í˜‘ ìµœì¢… ë°œí‘œ","êµ­ë¯¼ì€í–‰ ë™ê³„ ì¸í„´ì‹­ ìµœì¢… ë°œí‘œ", "í€ë“œíˆ¬ììë¬¸ì‚¬ ì¸ë ¥ ë°œí‘œ"],
                "20ì¼": ["ìˆ˜í˜‘ì¤‘ì•™íšŒ ìµœì¢… ë°œí‘œ"],
                "21ì¼": ["ì¬ê²½ê´€ë¦¬ì‚¬ ì‹œí—˜", "ATìê²© ì‹œí—˜", "íšŒê³„ê´€ë¦¬ ì‹œí—˜"],
                "22ì¼": [],
                "23ì¼": ["ìš°ë¦¬ì€í–‰ ì²´í—˜í˜• ì¸í„´ ë©´ì ‘"],
                "24ì¼": ["ìš°ë¦¬ìì‚°ìš´ìš© ìµœì¢… ë°œí‘œ"],
                "25ì¼": [],
                "26ì¼": ["ì‹ í˜‘ì¤‘ì•™íšŒ ì„œë¥˜ ë°œí‘œ", "ì „ì‚°ì„¸ë¬´íšŒê³„ ë°œí‘œ"],
                "27ì¼": ["ì¬ê²½ê´€ë¦¬ì‚¬ ë°œí‘œ", "íšŒê³„ê´€ë¦¬ ë°œí‘œ"],
                "28ì¼": ["í…Œì…‹ ì‹œí—˜"]
            }
        }

        # ì´ë²¤íŠ¸ë¡œ ë³€í™˜
        for day, events in calendar_data["12ì›”"].items():
            if events:  # ì´ë²¤íŠ¸ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¶”ê°€
                date = f"2024-12-{int(day[:-1]):02d}"  # "1ì¼" -> "2024-12-01"
                for event in events:
                    category = self.get_event_category(event)
                    self.calendar_events.append(
                        {
                            "title": event,
                            "start": date,
                            "color": self.color_map[category],
                            "category": category
                        }
                    )

    def get_event_category(self, event):
        """ì´ë²¤íŠ¸ ì œëª©ì— ë”°ë¼ ì¹´í…Œê³ ë¦¬ë¥¼ ë°˜í™˜"""
        if "ë°œí‘œ" in event and "ë©´ì ‘" not in event and "ì„œë¥˜" not in event:
            return "ë°œí‘œì¼"
        elif "ë©´ì ‘" in event:
            return "ë©´ì ‘"
        elif "ë°œí‘œ" in event:
            return "ë°œí‘œ"
        elif "ì„œë¥˜ ì‹œì‘" in event:
            return "ì„œë¥˜ ì‹œì‘"
        elif "ì„œë¥˜ ë§ˆê°" in event:
            return "ì„œë¥˜ ë§ˆê°"
        elif "ì‹œí—˜" in event:
            return "ì‹œí—˜ì¼"
        else:
            return "ì‹œí—˜ ì ‘ìˆ˜"

    def render(self):
        st.subheader("ğŸ“… ê¸ˆìœµê¶Œ ì±„ìš© & ìê²©ì¦ ìº˜ë¦°ë”")

        # ì…€ë ‰íŠ¸ ë°•ìŠ¤ ì¹´í…Œê³ ë¦¬ ì„ íƒ
        categories = [
            "ì „ì²´ ë³´ê¸°", "ë°œí‘œ", "ë©´ì ‘", "ì„œë¥˜ ì‹œì‘", "ì„œë¥˜ ë§ˆê°",
            "ì‹œí—˜ì¼", "ë°œí‘œì¼", "ì‹œí—˜ ì ‘ìˆ˜"
        ]
        selected_category = st.selectbox("ì¹´í…Œê³ ë¦¬ ì„ íƒ", categories)

        # í•„í„°ë§ëœ ì´ë²¤íŠ¸
        if selected_category == "ì „ì²´ ë³´ê¸°":
            filtered_events = self.calendar_events  # ëª¨ë“  ì´ë²¤íŠ¸ í‘œì‹œ
        else:
            filtered_events = [
                event for event in self.calendar_events
                if event["category"] == selected_category
            ]

        # ìº˜ë¦°ë” ì¶œë ¥
        calendar(events=filtered_events, options=self.calendar_options)

def show():
    app = CalendarApp()
    app.render()

if __name__ == "__main__":
    show()
